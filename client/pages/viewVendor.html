<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPD-POModule</title>
    <link rel="icon" href="../assets/images/logo.png">
    <link href="https://cdn.datatables.net/2.0.1/css/dataTables.dataTables.min.css" rel="stylesheet">
    <link href="../assets/css/main.css" rel="stylesheet">
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <script src="../assets/js/jquery-3.7.1.min.js"></script>
    <script src="../assets/js/utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.datatables.net/2.0.1/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.0.0/js/dataTables.buttons.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.0.0/js/buttons.bootstrap5.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.0.0/js/buttons.dataTables.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.0.0/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.0.0/js/buttons.print.min.js"></script>
    <div class="col-12 d-flex justify-content-center mt-2">
        <div class="card col-12 col-md-10 col-lg-9">
            <div class="card-header">
                <div class="row">
                    <h3 id="vendorTitle" class="col-8">(Vendor Name here)</h3>
                    <button type="button" class="btn btn-primary col-2 offset-2"
                        onclick="javascript:returnHome('vendors')">Return</button>
                </div>
            </div>
            <div class="card-body">
                <div class="row mb-5">
                    <div class="card col-9 mx-2">
                        <div class="row">
                            <div class="col-3 p-3">
                                <!-- NOT IN LOVE WITH THIS, THINK OF WHAT ELSE WE COULD ADD IN HERE -->
                                <p><b> Wesbite: </b> </b></p>
                                <p><b> Status: </b></p>
                            </div>
                            <div class="col-3 p-3">
                                <p id="pWebsite"> placeholder </p>
                                <p id="pStatus"> placeholder </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-2">
                        <button type="button" class="btn btn-info col-12 offset-3 mb-2" data-bs-toggle="modal"
                            data-bs-target="#editVendor"><!-- Add Functionality -->
                            Edit Vendor
                        </button>

                        <button type="button" class="btn btn-success col-12 offset-3 mb-2" data-bs-toggle="modal"
                            data-bs-target="#addContact"><!-- Add Functionality -->
                            Add Contact
                        </button>

                        <button id="btnDelete" type="button" class="btn btn-danger col-12 offset-3 mb-2"><!-- Add Functionality -->
                            Delete Vendor
                        </button>


                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-stripe responsive" id="tblVendorContacts">
                        <thead>
                            <tr>
                                <th>Contact Name</th>
                                <th>Address</th>
                                <th>Office Phone</th>
                                <th>Mobile Phone</th>
                                <th>Email</th>
                            </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
                
                <hr>

                <div class="table-responsive">
                    <table class="table table-stripe responsive" id="tblVendorPOs">
                        <thead>
                            <tr>
                                <th>Purchase Order ID</th>
                                <th>Date</th>
                                <th>Created By</th>
                                <th>Fiscal Year</th>
                            </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Vendor Modal -->
    <div class="modal fade" id="editVendor" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Edit Vendor</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <label for="txtEditVendorName" class="form-label">Vendor</label>
                    <input type="text" class="form-control" id="txtEditVendorName" placeholder="Vendor Name">

                    <label for="txtEditVendorLink" class="form-label">Website</label>
                    <input type="text" class="form-control" id="txtEditVendorLink" placeholder="Website">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" aria-label="Finish vendor edit">Edit</button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" aria-label="Close edit modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Contact Modal -->
    <div class="modal fade" id="addContact" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Add Contact</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <label for="txtContactName" class="form-label">Contact Name</label>
                    <input type="text" class="form-control" id="txtContactName" placeholder="Contact Name">

                    <label for="txtContactAddress" class="form-label">Address</label>
                    <input type="text" class="form-control" id="txtContactAddress" placeholder="Address">

                    <label for="txtOfficePhone" class="form-label">Office Phone</label>
                    <input type="tel" class="form-control" id="txtOfficePhone" placeholder="123-456-7890">

                    <label for="txtMobilePhone" class="form-label">Mobile Phone</label>
                    <input type="tel" class="form-control" id="txtMobilePhone" placeholder="123-456-7890">

                    <label for="txtVendorEmail" class="form-label">Email</label>
                    <input type="email" class="form-control" id="txtVendorEmail" placeholder="johndoe@gmail.com">

                    <label for="chkPrimaryContact" class="form-label">Primary Contact</label>
                    <input type="checkbox" class="form-check-input" id="chkPrimaryContact">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" aria-label="Add vendor contact">Add</button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" aria-label="Close edit model">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"
        integrity="sha384-cn7l7gDp0eyniUwwAZgrzD06kc/tftFfF7eSY6KjX83lXvyPcLa5VOWMR4Em10Ej"
        crossorigin="anonymous"></script>
    <script>
        var VendorName = "";
        $(document).ready(function () {
            VendorName = new URL(window.location.href).searchParams.get("VendorName");
            $('#vendorTitle').text(VendorName);
            $.ajax({
                type: 'POST',
                url: 'http://34.224.145.158:8000/getVendorInfo',
                data: JSON.stringify({ uuidSessionToken: sessionStorage.getItem('SimpleSession'), strVendorName: VendorName}),
                contentType: 'application/json',
                success: function (results) {
                    console.log(results);
                    if(results.VendorInfo[0].Website != '') {
                        $('#pWebsite').html('<a href="http://' + results.VendorInfo[0].Website + '" target="_blank">' + results.VendorInfo[0].Website + '<a>');
                    } else {
                        $('#pWebsite').text('N/A');
                    }
                    $('#pStatus').text((results.VendorInfo[0].Status == "1") ? "Active" : "Inactive");
                }
            })

            //getUserSettings();
        })

        $('#tblVendorContacts').DataTable({
            responsive: true,
        })

        $('#tblVendorPOs').DataTable({
            responsive: true,
        })

        $('#btnDelete').on('click', function(){
            $.ajax({
                type: 'DELETE',
                url: 'http://34.224.145.158:8000/deleteVendor',
                data: JSON.stringify({ uuidSessionToken: sessionStorage.getItem('SimpleSession'), strVendorName: sessionStorage.getItem('VendorName') }),
                contentType: 'application/json',
                success: function(results){
                    returnHome('vendors');
                }
            })
        })

    </script>
</body>

</html>